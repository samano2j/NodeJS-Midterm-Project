<%- include('partials/head.ejs') %>
<div class="flex flex-col text-center w-4/5 m-auto">
<h1 class="">Welcome <%= currentUser %>!</h1>
<form action="/twitter/home" method="POST" class="form-post">
  <textarea
  rows="2" 
  type="text"
  name="content" 
  placeholder="Post something"></textarea>
  <button class="self-end" type="submit">Post</button>
</form>
<ul>
    <% tweetData.forEach(tweet => { %>
    <li>
      <div class="max-w-sm flex flex-col justify-between gap-2">
      <div>
      <a href="/twitter/<%= tweet.user_id %>"><%= tweet.username %></a>
      <p class="whitespace-pre-line"><%= tweet.content %></p>
      </div>
      <div class="flex items-center gap-10">
      <div class="flex gap-5 items-center">
      <form action="/twitter/like/<%= tweet.post_id %>" method="POST">
        <button class="<% if (tweet.isLiked.length > 0) {  %>
          buttonLike
        <% } else { %>
          buttonDisable
        <% } %>" type="submit">
          <% if (tweet.isLiked.length > 0) {  %>
            Unlike
          <% } else { %>
            Like
          <% } %>
        </button>
      </form>
      <p><%= tweet.numLikes %></p>
      </div>
      <p class="text-sm"><%= tweet.formatDate %></p>
      </div>
      </div>
      <div class="flex flex-col gap-2 self-center">
      <% if (currentUser !== tweet.username) { %>
      <a class="buttonDisable">Update</a>
      <% } else { %>
      <a class="button" href="/twitter/edit/post/<%= tweet.post_id %>">Update</a>
      <% } %>
      <form action="/twitter/<%= tweet.post_id %>?_method=DELETE" method="POST">
        <% if (currentUser !== tweet.username) { %>
          <button class="buttonDisable" type="submit" disabled>Delete</button>
        <% } else { %>
          <button class="button" type="submit">Delete</button>
        <% } %>
      </form>
      <a class="button" href="/twitter/post/<%= tweet.post_id %>">Comment</a>
      </div>  
    </li>
    <% }); %>
</ul>
</div>

<%- include('partials/foot.ejs') %>